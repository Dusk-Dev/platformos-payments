---
slug: create-payment-new-cc
layout_name: ''
authorization_policies:
---

{% assign email = "test21323@gmail.com" %}
{% query_graph 'modules/payments/get_customer_by_email', result_name: "g_customer", email: email %}

{% assign customer =  g_customer.customizations.results.first %}
{% assign customer_id =  customer.id | append: '' %}

{% query_graph 'modules/payments/get_credit_cards_by_customer_id', result_name: 'g_cards', customer_id: customer_id %}

{% assign credit_card = g_cards.customizations.results.last %}

{%- parse_json 'data' -%}
  {
    "email": "{{ email }}",
    "currency": "CAD",
    "description": "My Last Payment",
    "statement_descriptor": "Statement description",
    "capture": "true",
    "destination": "",
    "transfer_group": "",
    "amount": "300",
    "metadata": ""
  }
{%- endparse_json -%}

{%-
  include_form 'modules/payments/gateway_request_form',
  gateway: 'stripe'
  request_type: 'create_payment'
  redirect_to: '/create-payment-new-cc'
  button: "Charge My Credit Card"
  data: data
%}


