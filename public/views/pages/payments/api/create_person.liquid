---
slug: payments/api/persons
method: post
format: json
layout_name: ''
authorization_policies:
---

{%- comment -%}{%- log params, type: "DEBUG CREATE PERSON API" %}{%- endcomment -%}
{%- assign account_id = context.params.account_id %}
{%- assign person_id = context.params.person_id %}
{%- assign token = context.params.person_token %}
{%- assign gateway_api_template = "modules/stripe/create_person" -%}

{% parse_json 'person_data' %}
  {
    "gateway_id": "{{ person_id }}",
    "account_id": "{{ account_id }}",
    "person_token": "{{ token }}"
  }
{% endparse_json %}

{% comment %}{% log person_data, type: "PERSON DATA" %}{% endcomment %}

{%- graphql person_response = 'modules/payments/gateway_request', data: person_data, api_template: gateway_api_template -%}
{% comment %}{% log person_response, type: "Person Response" %}{% endcomment %}
{% parse_json response %}{{ person_response.api_call_send.response }}{% endparse_json %}
{% if response.status == "200" %}
{{ person_response | json }}
{% else %}
  {{ response | json }}
{% endif %}
