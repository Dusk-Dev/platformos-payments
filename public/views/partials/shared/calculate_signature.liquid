  {%- assign key = redirect_to -%}
  {%- for property in data -%}
    {%- if signature_properties == blank or signature_properties contains property.first -%}
      {%- assign key = key | append: '|' | append: property.last -%}
    {%- endif -%}
  {%- endfor -%}
  {{- key | compute_hmac: context.constants.payment_secret -}}
